<head>
    <style>

        body{
            background-image: url('/img/CrudGeral.jpg');
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }
        .mesaContainer{
            width: 100%;
            height: 600px;
            background-color: white;
            border-radius: 10px;
            display: flex;
        }
        .mesaOptions{
            flex: 1;
            display: flex;
            flex-direction: column;
            box-shadow: 5px 0px 4px rgb(110, 110, 110);
        }
        .Option{
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid grey;
            border-right: 1px solid grey;
        }
        .Option:hover{
            background-color: grey;
            transition: 0.7s;
        }
        
        .mesaContentContainer{
            
            flex: 4;
            display: flex;
            flex-direction: column;
        }
        .OptionOptions{
            flex:1;
            display: flex;
            padding-left: 10px;
            box-shadow: 0px 5px 4px rgb(110, 110, 110);
        }
        .OptionsResults{
            
            flex: 7;
            display:flex;
            flex-direction: column;
            padding-left: 10px;
        }
        .OptionsResultsResponse{
            height: 90%;
            display: flex;
            flex-direction: column;
        }
        .Pesquise{
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #OptionUltimo:hover{
            border-bottom-left-radius: 10px;
        }
        #OptionUM:hover{
            border-top-left-radius: 10px;
        }
    </style>
</head>

<body >
    <script>
    function criaInputs(){

        var botao = document.getElementById('botao_')
        botao.setAttribute('onclick','filtraQuery()')
        // preciso aprender a criar inputs dinamicamente
        var newu = document.querySelector('.OptionOptions')
        if(newu.children.length < 2){
            arr_titlos = ['Nome']
            arr_titlos.forEach((titulo)=>{
                console.log(titulo)
                if(titulo == 'Idade'){
                    div = document.createElement('div')
                    div.style.display = 'flex'
                    div.style.alignItems = 'center'
                    div.style.justifyContent = 'center'
                    div.style.padding = '5px'
                    div.setAttribute('name',`divUser${titulo}`)
                    newu.appendChild(div)

                    idadeTitle = document.createElement('h6')
                    titulo_ = document.createTextNode(titulo)
                    idadeTitle.appendChild(titulo_)
                    div.appendChild(idadeTitle)

                    input = document.createElement('INPUT')
                    input.setAttribute('type','number')
                    input.setAttribute('name',`UsersCampo${titulo}`)
                    input.setAttribute('id',`Campo${titulo}`)
                    input.setAttribute('class',`form-control`)
                    input.style.flex = '1'
                    div.appendChild(input)
                    console.log(div.childNodes)
                }else{
                    
                    div = document.createElement('div')
                    div.setAttribute('name',`divUser${titulo}`)
                    div.style.display = 'flex'
                    div.style.alignItems = 'center'
                    div.style.padding = '5px'
                    newu.appendChild(div)

                    input = document.createElement('INPUT')
                    input.setAttribute('type','text')
                    input.setAttribute('id',`UsersCampo${titulo}`)
                    input.setAttribute('placeholder',titulo)
                    input.setAttribute('class',`form-control`)
                    div.appendChild(input)

                    console.log(div.childNodes)

                }
            })
            console.log(newu.childNodes)

            
            
            
        }
        
        
    }
    function filtraQuery(){
        var divResutado = document.getElementById('Resultado')
        divResutado.style.padding = '10px'
        var verificaFilhosResultado = divResutado.childNodes

        if(verificaFilhosResultado.length > 0){
            while(verificaFilhosResultado.length > 0){
                verificaFilhosResultado.forEach((el)=>{
                divResutado.removeChild(el)
                })
            }
            
        }
        
        
        var Nome = document.getElementById('UsersCampoNome')

        var queryResultform = document.getElementById(`${Nome.value}`)
        
        var filhos = queryResultform.childNodes
        console.log(filhos)


        // aqui eu tiro os elementos #text da lista de childs do form escolhido pelo nome no input
        filhos_sem_text = []//dados da pesquisa
        for(i=0;i<filhos.length;i++){
            if(i%2 !==0){
                filhos_sem_text.push(filhos[i])
            }
        }
        
        // ja tenho os dados separados para mostrar na divresult 
        // agora tenho que criar o tamplate para mostrar cada elemento

        nomes_campo_result=['User name','Nome','Nascimento','Email','Sexo','É admin']
        cont = 0
        nomes_campo_result.forEach((el)=>{
            var div_campo_result = document.createElement('div')
            div_campo_result.style.width = '100%'
            div_campo_result.style.paddingBottom = '5px'
            var p = document.createElement('p')
            var conteudo = document.createTextNode(`${el}: ${filhos_sem_text[cont].value}`)
            p.appendChild(conteudo)
            div_campo_result.appendChild(p)
            console.log(div_campo_result)
            cont++
            divResutado.appendChild(div_campo_result)
        })
      
        
    }

     function criaInputsAluno(){// preciso aprender a criar inputs dinamicamente
        var botao = document.getElementById('botao_')
        console.log(botao.getAttribute('onclick'))
        if(botao.getAttribute('onclick') == 'string' || botao.getAttribute('onclick') == null ){
            botao.removeAttributeNode('onclick')
            botao.setAttribute('onclick','filtraQueryAluno()')
        }

        var newu = document.querySelector('.OptionOptions')
        if(newu.children.length < 2){
            arr_titlos = ['Nome']
            arr_titlos.forEach((titulo)=>{
                console.log(titulo)
                if(titulo == 'Idade'){
                    div = document.createElement('div')
                    div.style.display = 'flex'
                    div.style.alignItems = 'center'
                    div.style.justifyContent = 'center'
                    div.style.padding = '5px'
                    div.setAttribute('name',`divUser${titulo}`)
                    newu.appendChild(div)

                    idadeTitle = document.createElement('h6')
                    titulo_ = document.createTextNode(titulo)
                    idadeTitle.appendChild(titulo_)
                    div.appendChild(idadeTitle)

                    input = document.createElement('INPUT')
                    input.setAttribute('type','number')
                    input.setAttribute('name',`UsersCampo${titulo}`)
                    input.setAttribute('id',`Campo${titulo}`)
                    input.setAttribute('class',`form-control`)
                    input.style.flex = '1'
                    div.appendChild(input)
                    console.log(div.childNodes)
                }else{
                    
                    div = document.createElement('div')
                    div.setAttribute('name',`divUser${titulo}`)
                    div.style.display = 'flex'
                    div.style.alignItems = 'center'
                    div.style.padding = '5px'
                    newu.appendChild(div)

                    input = document.createElement('INPUT')
                    input.setAttribute('type','text')
                    input.setAttribute('id',`UsersCampo${titulo}`)
                    input.setAttribute('placeholder',titulo)
                    input.setAttribute('class',`form-control`)
                    div.appendChild(input)

                    console.log(div.childNodes)

                }
            })
            console.log(newu.childNodes)

            
            
            
        }
        
        
    }
</script>
    {{#each User}}
        <form action="" id="{{this.nome}}">
            <input type="hidden" id="'userName{{this.nome}}" value="{{this.userName}}">
            <input type="hidden" id="nome{{this.nome}}" value="{{this.nome}}">
            <input type="hidden" id="nascimento{{this.nome}}" value="{{this.nascimento2}}">
            <input type="hidden" id="email{{this.nome}}" value="{{this.email}}">
            <input type="hidden" id="sexo{{this.nome}}" value="{{this.sexo}}">
            <input type="hidden" id="admin{{this.nome}}" value="{{this.EhAdmin}}">
        </form>
    {{/each}}
    <div class="mesaContainer">
        <div class='mesaOptions'>
            <div class="Option" id="OptionUM" onclick="criaInputs()">
                Users
            </div>
            <div class="Option" onclick="criaInputsAluno()" >
                Alunos
            </div>
            <div class="Option">
                Musculação
            </div>
            <div class="Option" id="OptionUltimo">
                Cross
            </div>

        </div>
        <div class="mesaContentContainer">
            <div class="OptionOptions">
                <div class="Pesquise">
                    <h6>Pesquise por:</h6>
                </div>
                <!-- Aqui vão as divs adicionadas pelo js -->
            </div>
            <div class="OptionsResults">
                <div class="OptionsResultsResponse" id="Resultado">
                    
                </div>
                <div class="Pesquise">
                    <button class="btn btn-success"  id="botao_">pesquisar</button>
                </div>
                
            </div>
 
        </div>

    </div>
</body>



